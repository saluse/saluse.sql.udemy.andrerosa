--AULA 050
--RANK: EXEMPLO 2:1
/*
 AS FUNÇÕES DE CLASSIFICAÇÃO RETORNAM UM VALOR DE CLASSIFICAÇÃO PARA CADA LINHA EM UMA PARTIÇÃO. DEPENDENDO DA FUNÇÃO USADA, 
ALGUMAS LINHAS PODEM RECEBER O MESMO VALOR QUE OUTRAS. AS FUNÇÕES DE CLASSIFICAÇÃO SÃO NÃO DETERMINISTICAS.
*/
SELECT RANK() OVER (ORDER BY Estado ASC) AS rank_uf ,
		estado
FROM uf

-- RANK EXEMPLO 2
SELECT RANK() OVER (ORDER BY Estado ASC) AS rank_uf,
	Regiao, 
	Estado
FROM regiao_uf

-- RANK EXEMPLO 3
SELECT RANK() OVER (ORDER BY Regiao ASC) AS rank_uf,
	Regiao,
	Estado
FROM regiao_uf

-- NTILE
/* 
DISTRIBUI AS LINHAS DE UMA PARTIÇÃO ORDENADA EM UM NÚMERO DE GRUPOS EPESCIFICADOS.
OS GRUPOS SÃO NUMERADOS, INICIALMENTE EM UM. PARA CADA LINHA, NTILE RETORNA O NÚMERO DO GRUPO AO QUAL A LINHA PERTENCE.
*/
SELECT NTILE(5) OVER (ORDER BY Regiao ASC) AS Ntile_uf,
	Regiao,
	Estado
FROM regiao_uf

-- AULA 051
/*
RETORNA A CLASSIFICAÇÃO DE LINHAS DENTRO DA PARTIÇÃO DE UM CONJUNTO DE RESULTADOS,
SEM QUALQUER LACUNA NA CLASSIFICAÇÃO. A CLASSIFICAÇÃO DE UMA LINHA É UM MAIS O NÚMERO DE CLASSIFICAÇÕES DISTINTAS QUE VÊM ANTES DA LINHA EM QUESTÃO.
*/
SELECT DENSE_RANK() OVER (ORDER BY Regiao ASC) AS dense_rank_uf,
	Regiao,
	Estado
FROM Regiao_uf

SELECT DENSE_RANK() OVER (ORDER BY Estado ASC) AS DENSE_RANK_UF,
	regiao,
	estado
FROM regiao_uf

